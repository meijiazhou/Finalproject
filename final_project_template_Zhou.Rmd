---
title: "EPID 600 Project - Association between health behavior factors and Internet use to obtain health information"
author: Meijia Zhou
output: html_document
---

Use this template to complete your project throughout the course. Your Final Project presentation in class will be based on the contents of this document. Due dates:

- Topic choice: 9/18/15
- List of faculty/staff to be contacted: 10/2/15
- Complete overview with data source to address a specific problem identified: 10/16/15
- Introduction: 10/30/15
- Methods and Results draft: 11/13/15
- Final Document: 11/30/15

### Overview
Increasing number of people are using Internet to obtain health informtion. Characterization of the population using Internet to obtain health information would help researchers to understand the population, facilitate health information dissemination through Internet and/or develop programs that better targets the population. The objective of this project is to identify health behavior factors associated with using Internet to obtain health information. Specifically, this project is to determine whether smoking status and alcohol drinking status are associated with Internet use to get health information using 2014 National Health Interview Survey (NHIS) Data [http://www.cdc.gov/nchs/nhis/nhis_2014_data_release.htm]. I spoke with three faculty members/fellows and received very helpful insights/advices from them. Dr. Young Hee Nam, Postdoc research fellow at Department of Clinical Epidemiology and Biostatistics, who had background in health policy and management provided me information on regulatory aspects on health information available on the Internet. She also gave me lots of information on this topic in general, including recent relevant publications on this topic and many good resources/websites to look for additional information. I also met with Dr. Ashkan Ertefaie at Department of Statistics in Wharton School of Business for advices on the statistical methods including how to build the models, covariate selection and methods to adjust for the sampling design of NHIS using weights in R. Dr. Haochang Shou, Assistant Professor of Biostatistics at Department of Clinical Epidemiology and Biostatistics also gave me advices on methods of building models, methods to make group comparisons and graphical presentation of data. I acknowledge them for all their help/advices on this project.

Link to the Github repository of this project: https://github.com/meijiazhou/Finalproject

### Introduction 
Internet use had changed our lives dramatically in the past several decades. In 2014, 87% of U.S adults use Internet(1), while 72% of Internet users claim use of Internet to obtain health information (2). The increasing trend in use of Internet to seek health information had been observed in other countries as well (3) . Internet offers an alternative approach for individuals to obtain health information when needed. Studies suggested that Internet use facilitates improvement in health outcomes by making more health information available and easily accessible, giving social support, improving self-efficacy of the subject as well as facilitating interactions between patients and the healthcare system (4,5). Despite patients, Internet is also being used by increasing number of researchers and/or healthcare providers to collect information from individuals, to provide healthcare through emails or web-based interfaces, and to implement health interventions through online programs. Internet-based intervention programs to promote health behavior change had shown small but clinically significant effectiveness (6-9). As prevalence of access to Internet continues to increase among the general population, it is important to understand who are using the Internet to search for health information, why and how they are using it. Understanding the target population would facilitate dissemination of useful health information to patients and improved efficacy of the Internet based systems. This study is to investigate the relationship between health behavior factors and use of the Internet to obtain health information using National Health Interview Survey (NHIS), a large national representative cross-sectional survey. 

NHIS is a large survey that provides a broad range of information on the health of the civilian non-institutionalized population in the United States. The data is widely used by epidemiologist to monitor disease and disability trends as well as the progress of achieving national health objectives. Health policy researchers also utilize it to evaluate health programs and to identify barriers of access to care. The survey is designed using epidemiologic methods and epidemiologic methods are needed to build the model to answer the research question of interest for this project. Bio-statistical methods are needed to analyze such large samples, to account for the complex multi-stage sampling design of NHIS as well as to ensure correct statistical models are build. Background information on the current status of this general topic is provided largely by joint efforts of epidemiologists, health policy researchers and health behavior researchers. For example, relationship between use of Internet to access health information and access to care was analyzed by health policy researchers based on the hypothesis that subjects had difficulties with access to care may switch to Internet to obtain health information when needed(10). The result of this study could also be useful for health behavior researches to design targeted Internet-based intervention programs to promote health behavior changes. 

### Methods
Data
This project used data from the 2014 National Health Interview Survey (NHIS). NHIS is a large cross-sectional household interview survey that collected information on a broad range of information on the health of the civilian non-institutionalized population in the United States conducted by the National Center for Health Statistics (NCHS) and the Centers for Disease Control and Prevention (CDC). Using computer-assisted personal interviewing, personal household interviews were conducted to collect health information annually. The survey consisted of a core questionnaire that mainly remains unchanged every year and a supplementary survey that varies depending on current health topics. NHIS follows a multi-stage sampling design to select households. To increase precision of the estimates of minorities, black, Hispanic, as well as Asians aged 65 years and above are oversampled. For each family, one child aged 17 years or younger and one adult aged 18 years and above were randomly selected to complete the survey. Information collected from Sample Adult and Sample Child questionnaires are released as seperated files. This study uses the 2014 Sample Adult data that recorded responses from the sample adults and the Person data which included additional information on all adults and child [http://www.cdc.gov/nchs/nhis/nhis_2014_data_release.htm]. The response rate for sample adult survey was 80.5% (36,697/45,563) among all eligible adults. The published dataset by CDC included 33,697 adults aged 18 years and above, while 488 of them had a knowledgeable proxy to answer the questions for them and 528 of them had unknown status. For this analysis, only individuals who answered questions themselves and who had completed data on all the variables of interest were included in the analysis. 

Exposure
The exposure of interest are two behavior variables captured in the NHIS database, including the following: smoking status and alcohol drinking status. 

Smoking status was measured as current every day smoker, current some day smoker, former smoker, never smoker, and smoker (with current status unknown), and unknown if ever smoked. Subjects with unknown status [i.e smoker (with current status unknown), and unknown if ever smoked)] were removed from the analysis. 

Alcohol consumption was originally measured as lifetime abstainer, former infrequent, former regular, former (unknown frequency), current infrequent, current light, current moderate, current heavier, current drinker (frequency/level unknown), and drinking status unknown. Subjects with unknown frequency or unknown alcohol drinking status were removed from the analyis. Then the alcohol drinking status is regrouped into four categories: lifetime abstainer, former drinker, current infrequent-light drinker, and current moderate-heavier drinker.

Outcome
The outcome of interest is use of Internet to look up health information. The NHIS 2014 includes the following questions that captured computer use to obtain health information by the interviewees. 
1)	During the past 12 months, have you ever used computer to look up health information on the Internet? 
2)	During the past 12 months, have you ever used computer to use online chat groups to learn about health topics? 
The answer to both questions were recorded as yes or no. People who refused to answer the questions or with unknown responses to these questions were dropped from the analysis. The outcome of interest for this study was a composite outcome of the two outcome measures described above. 

Covariates
Several covariates were included in the analysis including age, sex, race/ethnicity, marital status, body mass index (BMI), education level, geographical region of residence and general health status. Age and BMI was recorded as continous variables and were categorized in this study.

Statistical method
Weighted percentages within each level of covariates seperated by use of Internet to obtain health information were calculated. Demographics and general health status of the interviewees were compared using Chi-squared test between people who used computers to obtain health information and those who did not. Logistic regression was used to estimate the crude and adjusted odds ratio comparing people used computer to obtain health information versus those who did not. In the multivariate models for each health behavior factor, we adjusted for age, sex, race, education level, martial status, BMI, geographical region of residence and general health status. The annual adjusted weights were applied to all the regression models to account for the multistage sampling design and oversampling of the minorities. All the analysis were conducted using R. 

```{r eval=TRUE}
# Input NHIS2014 adult data in dta format 
# The original NHIS 2014 data was in ASCII format. NHIS provided sample STATA code to read in the data, add labels and convert it to dta format. The sample STATA code was ran to convert ASCII data into dta format. The sample adult data was merged with person data, and then only sample adults' records were kept in the dataset. This new dataset is saved as "data2014.dta"
# Use foreign package to import dta data
library(foreign)
mydata <- read.dta("/Users/meijiazhou/Documents/2015 Fall/EPID 600 Data Science/Final project/data2014.dta")
str(mydata)
# There were 36697 observations and 1411 variables in the original dataset 
# The dataset shared on Github is a subset of 'mydata', but contains more variables than those included for this analysis.  

## Create a dataset with all the variables of interest called "my.data"
my.data<-subset(mydata, select=c(wtia_sa, region, strat_p, psu_p, sex, racerpi2, age_p, r_maritl, proxysa, educ1, phstat, smkstat2, alcstat, bmi, hit1a, hit5a))
str(my.data)
# my.data has 36697 observations and 16 variables. 

library(dplyr)
## Data cleaning ##
# Mark people who answered the question by an proxy or with unknown status and coded their responses as "NA". So we can only keep the records for those who answered the questions by themselves in the analysis. 
table(my.data$proxysa)
my.data <- my.data  %>% 
    mutate(proxysa = ifelse(as.numeric(proxysa)==1, NA, proxysa)) %>%
    mutate(proxysa = ifelse(as.numeric(proxysa)==3, NA, proxysa)) 
table(my.data$proxysa)

## Prepare the analytic dataset for complete case analysis - look into each variable of interest and code the categories with missing data, with responses of unknown status, or with incomplete responses as "NA". For example, subjects who refused to answer the question, or former alcohol drinker with unknown frequency.
# Outcome variable - Use of Internet to obtain health information
# 1) Use of internet to look for health info?
table(my.data$hit1a)
my.data <- my.data  %>% 
    mutate(hit1a = ifelse(as.numeric(hit1a)==3, NA, hit1a)) %>%  
    mutate(hit1a = ifelse(as.numeric(hit1a)==4, NA, hit1a)) %>%  
    mutate(hit1a = ifelse(as.numeric(hit1a)==5, NA, hit1a))
my.data$hit1a<-factor(my.data$hit1a, labels=c("Yes", "No"))  
new.levels<-c(1,0)
my.data$hit1a<-factor(new.levels[my.data$hit1a])
my.data$hit1a<-factor(my.data$hit1a, labels=c("No", "Yes"))  
table(my.data$hit1a)

# 2) Use of online chat groups to learn about health topics?
table(my.data$hit5a)
my.data <- my.data  %>% 
    mutate(hit5a = ifelse(as.numeric(hit5a)==3, NA, hit5a)) %>%  
    mutate(hit5a = ifelse(as.numeric(hit5a)==4, NA, hit5a)) %>%  
    mutate(hit5a = ifelse(as.numeric(hit5a)==5, NA, hit5a)) 
new.levels<-c(1,0)
my.data$hit5a<-factor(new.levels[my.data$hit5a])
my.data$hit5a<-factor(my.data$hit5a, labels=c("No", "Yes"))  
table(my.data$hit5a)

# Create a new variable for the composite outcome of the two variables above
my.data$hit1a<-as.numeric(my.data$hit1a)
my.data$hit5a<-as.numeric(my.data$hit5a)
my.data$outcome<-(my.data$hit1a + my.data$hit5a)
my.data$outcome<-as.factor(my.data$outcome)
table(my.data$outcome)
# assign new levels and add labels to the new outcome variable
new.levels<-c(0,1,1)
my.data$outcome<-factor(new.levels[my.data$outcome])
my.data$outcome<-factor(my.data$outcome, labels=c("No", "Yes"))  
table(my.data$outcome)

## Exposure of interests
# Smoking status
levels(my.data$smkstat2)
table(my.data$smkstat2)
my.data <- my.data  %>% 
    mutate(smkstat2 = ifelse(as.numeric(smkstat2)==5, NA, smkstat2)) %>%  
    mutate(smkstat2 = ifelse(as.numeric(smkstat2)==6, NA, smkstat2)) 
my.data$smkstat2<-factor(my.data$smkstat2, labels=c("current every day smoker", "current some day smoker", "former smoker", "never smoker")) 
# Assign new levels
new.levels<-c(3,2,1,0)
my.data$smkstat2<-factor(new.levels[my.data$smkstat2])
my.data$smkstat2<-factor(my.data$smkstat2, labels=c("never smoker", "former smoker", "current some day smoker", "current every day smoker"))  
table(my.data$smkstat2)

# Alcohol consumption
levels(my.data$alcstat)
table(my.data$alcstat)
my.data <- my.data  %>% 
    mutate(alcstat = ifelse(as.numeric(alcstat)==4, NA, alcstat)) %>%  
    mutate(alcstat = ifelse(as.numeric(alcstat)==9, NA, alcstat)) %>%  
    mutate(alcstat = ifelse(as.numeric(alcstat)==10, NA, alcstat)) 
my.data$alcstat<-factor(my.data$alcstat, labels=c("Lifetime abstainer", "Former infrequent", "Former regular", "Current infrequent", "Current light", "Current moderate", "Current heavier"))
new.levels<-c(0,1,2,3,4,5,6)
my.data$alcstat<-factor(new.levels[my.data$alcstat])
my.data$alcstat<-factor(my.data$alcstat, labels=c("Lifetime abstainer", "Former infrequent", "Former regular", "Current infrequent", "Current light", "Current moderate", "Current heavier"))  
table(my.data$alcstat)
# Re-group as "Lifetime abstainer", "Former drinker", "Current infrequent-light drinker", "Current moderate-heavier drinker"
my.data$alcstat2<-my.data$alcstat
new.levels<-c(0,1,1,2,2,3,3)
my.data$alcstat2<-factor(new.levels[my.data$alcstat2])
my.data$alcstat2<-factor(my.data$alcstat2, labels=c("Lifetime abstainer", "Former drinker", "Current infrequent-light drinker", "Current moderate-heavier drinker"))  
table(my.data$alcstat2)

## Covariates of interest  
# a) Continuous variable (age and bmi): look at the summary statistics/distribution of each variable, create new categorical variables 
# b) Categorical variables: remove data for subjects with unknown status (i.e change it to NA), re-classify the groups and assign new levels when needed (eg: marital status, education level, and race)
## Demographics: 
# Age(age_p) - summary statistics for age
summary(my.data$age_p)
# Categorized age into three groups: 18-45, 46-65, 65+ years
my.data$agecat<-cut(my.data$age_p, breaks=c(18, 45, 65, Inf), labels=c("18-45", "46-65", "65+"))
table(my.data$agecat)

# Gender(sex) 
table(my.data$sex)

# Marital status (r_maritl) - Recode those with unknown status as "NA""
table(my.data$r_maritl)
my.data <- my.data  %>% 
    mutate(r_maritl = ifelse(as.numeric(r_maritl)==1, NA, r_maritl)) %>%
    mutate(r_maritl = ifelse(as.numeric(r_maritl)==10, NA, r_maritl)) 
my.data$r_maritl<-factor(my.data$r_maritl)  
table(my.data$r_maritl)
levels(my.data$r_maritl)
# Categorized marital status into new groups: Never Married, Married/Living with Partner, Divorced/Seperated, Widowed
new.levels<-c(1,1,3,2,2,0,1)
my.data$r_maritl<-factor(new.levels[my.data$r_maritl])
my.data$r_maritl<-factor(my.data$r_maritl, labels=c("Never Married", "Married/Living with Partner", "Divorced/Seperated", "Widowed"))  
levels(my.data$r_maritl)
table(my.data$r_maritl)

# Region(region)
table(my.data$region)

# Race(racerpi2)
table(my.data$racerpi2) 
levels(my.data$racerpi2)
# Categorize race into new groups
new.levels<-c(1,2,3,4,5,5)
my.data$racerpi2<-factor(new.levels[my.data$racerpi2])
my.data$racerpi2<-factor(my.data$racerpi2, labels=c("White", "Black/Aferican American", "American Indian Alaska Native", "Asian", "Multiple race/Other"))
levels(my.data$racerpi2)
table(my.data$racerpi2)

# BMI - Create categorical variable for bmi and add labels
summary(my.data$bmi)
my.data$bmicat<-cut(my.data$bmi, breaks=c(0, 18.5, 24.9, 29.9, 35, Inf), labels=c("underweight", "healthy", "overweight", "obese", "morbidly_obese"))
table(my.data$bmicat)

# Education level
table(my.data$educ1) 
my.data <- my.data  %>% 
    mutate(educ1 = ifelse(as.numeric(educ1)==23, NA, educ1)) %>%
    mutate(educ1 = ifelse(as.numeric(educ1)==24, NA, educ1)) %>%
    mutate(educ1 = ifelse(as.numeric(educ1)==25, NA, educ1)) %>%
    mutate(educ1 = ifelse(as.numeric(educ1)==26, NA, educ1))
table(my.data$educ1) 
# Categorized into new groups: Less than high school, High School/GED, Associate, Bachelor, Graduate degree
new.levels<-c(0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,2,3,4,4,4)
my.data$educ1<-factor(new.levels[my.data$educ1])
my.data$educ1<-factor(my.data$educ1, labels=c("Less than High School", "High School/GED", "Associate", "Bachelor", "Graduate Degree"))  
table(my.data$educ1)

## General health status
table(my.data$phstat)
my.data <- my.data  %>% 
    mutate(phstat = ifelse(as.numeric(phstat)==6, NA, phstat)) %>%
    mutate(phstat = ifelse(as.numeric(phstat)==7, NA, phstat)) %>%
    mutate(phstat = ifelse(as.numeric(phstat)==8, NA, phstat))
table(my.data$phstat) 
# Assign new levels
new.levels<-c(0,1,2,3,4)
my.data$phstat<-factor(new.levels[my.data$phstat])
my.data$phstat<-factor(my.data$phstat, labels=c("Excellent", "Very Good", "Good", "Fair", "Poor"))  
table(my.data$phstat)

####  using the survey package to account for the complex design of the NHIS survey
library(survey)
## create svydesign 
nhissvy <- svydesign(id=~psu_p, strata=~strat_p, nest=TRUE, weights=~wtia_sa, data=my.data)
nhis.complete <- na.omit(nhissvy)
```

### Results
```{r eval=TRUE}
## Descriptive analysis 
## Percentage of subjects in each outcome group
# Distribution of each component of the outcome
a<-svymean( ~interaction(hit5a, hit1a), design=nhissvy, na.rm=TRUE)
b<-ftable(a, rownames=list(hit5a=c("No", "Yes"), hit1a=c("No", "Yes")))
b
# Distribution of the outcome
a<-svymean(~outcome, design=nhissvy, na.rm=TRUE)
a
# Plot the percentage of subjects with and without the outcome (i.e use of Internet to obtain health information)
colors<-c("lightblue", "mistyrose")
barplot(a, main="Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("No", "Yes"), fill=colors, cex=0.80)

## Percentage of people within each categories of independent variables (exposures and covariates) by outcome
## Compare the percentages of people within each categories of the covariate between subjects who reported use of Internet to obtain health information vs. those who did not. Present table of percentages by outcome, plot the distributions and perform Chi squared test for each independent variable.
# Exposures
# Smoking status
a<-svyby( ~smkstat2, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of smoking status by outcome groups
colors<-c("lightblue", "mistyrose", "lightcyan", "lavender")
barplot(a, beside=TRUE, main="Distribution of Smoking Status by  \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("Never smoker", "Former smoker", "Some day smoker", "Every day smoker"), fill=colors, cex=0.60)
# Chi-squared test
svychisq(~outcome+smkstat2, design=nhissvy)

# Alcohol drinking status
a<-svyby( ~alcstat2, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of alcohol drinking status by outcome groups
colors<-c("lightblue", "mistyrose", "lightcyan", "lavender")
barplot(a, beside=TRUE, main="Distribution of Alcohol Drinking Status by \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("Lifetime abstainer", "Former drinker", "Current infrequent-light drinker", "Current moderate-heavy drinker"), fill=colors, cex=0.60)
# Chi-squared test
svychisq(~outcome+alcstat2, design=nhissvy)

# Covariates
# Social demographics
# Age groups
colors<-c("lightblue", "mistyrose", "lightcyan")
a<-svyby( ~agecat, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of age groups by outcome groups
barplot(a, beside=TRUE, main="Distribution of Age Groups by \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("Age 18-45", "Age 46-65", "Age 65+"), fill=colors, cex=0.60)
# Chi-squared test
svychisq(~outcome+agecat, design=nhissvy)

# Gender
colors<-c("lightblue", "mistyrose")
a<-svyby( ~sex, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of gender by outcome groups
barplot(a, beside=TRUE, main="Distribution of Sex by \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("Male", "Female"), fill=colors, cex=0.60)
# Chi-squared test
svychisq(~outcome+sex, design=nhissvy)

# Marital status
a<-svyby( ~r_maritl, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of marital status by outcome groups
colors<-c("lightblue", "mistyrose", "lightcyan", "lavender")
barplot(a, beside=TRUE, main="Distribution of Marital Status by \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("Never married", "Married/Living with Partner", "Divorsed/Seperated", "Widowed"), fill=colors, cex=0.60)
# Chi-squared test
svychisq(~outcome+r_maritl, design=nhissvy)

# Region
a<-svyby( ~region, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of region by outcome groups
colors<-c("lightblue", "mistyrose", "lightcyan", "lavender")
barplot(a, beside=TRUE, main="Distribution of Geographic Region by  \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("Northeast", "Midwest", "South", "West"), fill=colors, cex=0.60)
# Chi-squared test
svychisq(~outcome+region, design=nhissvy)

# Race/ethnicity
a<-svyby( ~racerpi2, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of race by outcome groups
colors<-c("lightblue", "mistyrose", "lightcyan", "lavender","cornsilk")
barplot(a, beside=TRUE, main="Distribution of Race/Ethnicity Group by  \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("White", "Black/Aferican American", "American Indian Alaska Native", "Asian", "Multiple race/Other"), fill=colors, cex=0.5)
# Chi-squared test
svychisq(~outcome+racerpi2, design=nhissvy)

# BMI
a<-svyby( ~bmicat, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of BMI by outcome groups
colors<-c("lightblue", "mistyrose", "lightcyan", "lavender","cornsilk")
barplot(a, beside=TRUE, main="Distribution of BMI by  \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("Underweight", "Healthy", "Overweight", "Obese", "Morbidly Obese"), fill=colors, cex=0.6)
# Chi-squared test
svychisq(~outcome+bmicat, design=nhissvy)

# Education level
a<-svyby( ~educ1, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of education level by outcome groups
colors<-c("lightblue", "mistyrose", "lightcyan", "lavender","cornsilk")
barplot(a, beside=TRUE, main="Distribution of Education Level by  \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("Less than highschool", "Higher school/GED", "Associate", "Bachelor", "Graduate"), fill=colors, cex=0.6)
# Chi-squared test
svychisq(~outcome+educ1, design=nhissvy)

# General health status
a<-svyby( ~phstat, ~outcome, nhissvy, svymean, na.rm=TRUE)
a
# Plot of general health status by outcome groups
colors<-c("lightblue", "mistyrose", "lightcyan", "lavender","cornsilk")
barplot(a, beside=TRUE, main="Distribution of General Health Status by  \n Use of Internet to Obtain Health Information", ylab="Percentage", ylim=c(0.0, 1.0), cex.lab=0.8, cex.main=1.0, cex.axis=0.8, col=colors, space=NULL)
legend("topright", legend=c("Excellent", "Very Good", "Good ", "Fair", "Poor"), fill=colors, cex=0.6)
# Chi-squared test
svychisq(~outcome+phstat, design=nhissvy)
```

Of 36,697 adults who completed the adult sample survey, 34,365 (93.6%) subjects with completed information on all variables of interest were included in this analysis. A total of 43.49% of all participants reported use of Internet to obtain health information in the past 12 months. Among all participants, 41.01% reported use of Internet to look up health information only, 0.16% only reported use of online chat groups to learn about health topics, and 2.31% reported answered yes to both questions. From the bar plots of the raw distribitions of independent variables by groups of subjects who used Internet to obtain health information versus those who did not, there were notable differences between the distributions of covariates within the two groups, especially for smoking status, alcohol drinkng status, age group, marital status, education level and general health status. The Chi squared tests suggested significant differences (p<0.05) in the weighted percentages of each categories of independent variables between participants who used Internet to obtain health information and those who did not. 

```{r eval=TRUE}
## Univariate analysis - perform simple logistic regression on each variable
# Univariate analysis for each covariates
# Age groups
exp(summary(svyglm(outcome ~ factor(agecat),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.1<-svyglm(outcome ~ factor(agecat),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.1))
# Gender
exp(summary(svyglm(outcome ~ factor(sex),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.2<-svyglm(outcome ~ factor(sex),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.2))
# Marital status
exp(summary(svyglm(outcome ~ factor(r_maritl),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.3<-svyglm(outcome ~ factor(r_maritl),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.3))
# Region
exp(summary(svyglm(outcome ~ factor(region),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.4<-svyglm(outcome ~ factor(region),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.4))
# Race/Ethnicity
exp(summary(svyglm(outcome ~ factor(racerpi2),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.5<-svyglm(outcome ~ factor(racerpi2),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.5))
# BMI
exp(summary(svyglm(outcome ~ factor(bmicat),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.6<-svyglm(outcome ~ factor(bmicat),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.6))
# Education level
exp(summary(svyglm(outcome ~ factor(educ1),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.7<-svyglm(outcome ~ factor(educ1),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.7))
# General health status
exp(summary(svyglm(outcome ~ factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.8<-svyglm(outcome ~ factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.8))

# Univariate analysis - Exposure of interest
# Smoking status
exp(summary(svyglm(outcome ~ factor(smkstat2),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.smk<-svyglm(outcome ~ factor(smkstat2),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.smk))
# Alcohol drinking status
exp(summary(svyglm(outcome ~ factor(alcstat2),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
glm.alc<-svyglm(outcome ~ factor(alcstat2),family=quasibinomial, design=nhissvy, na.action=na.omit)
# Crude OR
exp(confint(glm.alc))

## load ggplot2 package 
library(ggplot2)

## Multivariate analysis controlling for covariates
## Fit a model with all the covariates
glm.cov <- svyglm(outcome ~ factor(agecat) + factor(sex) + factor(r_maritl) + factor (region) + factor(racerpi2) + factor(bmicat) + factor(educ1) + factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit)

summary(svyglm(outcome ~ factor(agecat) + factor(sex) + factor(r_maritl) + factor (region) + factor(racerpi2) + factor(bmicat) + factor(educ1) + factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit))
# Adjusted ORs 
exp(summary(svyglm(outcome ~  factor(agecat) + factor(sex) + factor(r_maritl) + factor (region) + factor(racerpi2) + factor(bmicat) + factor(educ1) + factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
# Calculate CIs
exp(confint(glm.cov))

## Plot adjusted OR for age groups with 95% CI
df<-data.frame(Age_Group=c("18-45 years", "46-65 years", "65+ years"), Odds_Ratio=c(1, 0.8464819, 0.4681893), L=c(1, 0.7895090, 0.4274164), U=c(1, 0.9075661, 0.5128518))
ggplot(df, aes(x=Age_Group, ordered=TRUE, y=Odds_Ratio, color=Age_Group)) + geom_point(size=4) + geom_errorbar(aes(ymax=U, ymin=L, width=0.3)) +theme(axis.text.x=element_blank(), axis.text.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title.y=element_text(size=16)) 

## Plot adjusted OR for gender with 95% CI
df<-data.frame(Sex=c("Male", "Female"), Odds_Ratio=c(1, 1.6422092), L=c(1, 1.5360893), U=c(1,1.7556603))
ggplot(df, aes(x=Sex, ordered=TRUE, y=Odds_Ratio, color=Sex)) + geom_point(size=4) + geom_errorbar(aes(ymax=U, ymin=L, width=0.3)) +theme(axis.text.x=element_blank(), axis.text.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title.y=element_text(size=16))

## Plot adjusted OR for marital status with 95% CI
df<-data.frame(Marital_Status=c("Never Married", "Married/Living with Partner", "Divorced/Separated", "Widowed"), Odds_Ratio=c(1, 1.1880631, 0.9808306, 0.5220229), L=c(1, 1.0839881, 0.8710049, 0.4397107), U=c(1,1.3021304, 1.1045043, 0.6197437))
ggplot(df, aes(x=Marital_Status,ordered=TRUE, y=Odds_Ratio, color=Marital_Status)) + geom_point(size=4) + geom_errorbar(aes(ymax=U, ymin=L, width=0.3)) +theme(axis.text.x=element_blank(), axis.text.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title.y=element_text(size=16)) 

## Plot adjusted OR for Race with 95% CI
df<-data.frame(Race=c("White","Black/African American", "American Indian Alaska Native", "Asian", "Multiple race/Other"), Odds_Ratio=c(1, 0.6765274, 0.6537915, 0.5377963, 1.1111475), L=c(1, 0.6185706, 0.4600955, 0.4638531, 0.8711835), U=c(1, 0.7399144, 0.9290316, 0.6235267, 1.4172087))
ggplot(df, aes(x=Race,ordered=TRUE, y=Odds_Ratio, color=Race)) + geom_point(size=4) + geom_errorbar(aes(ymax=U, ymin=L, width=0.3)) +theme(axis.text.x=element_blank(), axis.text.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title.y=element_text(size=16)) 

## Plot adjusted OR for education level with 95% CI
edulevels<-c("Less than High School","High School/GED", "Associate", "Bachelor", "Graduate Degree")
df<-data.frame(Education=c("Less than High School","High School/GED", "Associate", "Bachelor", "Graduate Degree"), Odds_Ratio=c(1, 2.3396768, 5.1352488, 8.6940606, 10.9341795), L=c(1, 2.0552154, 4.5149340, 7.6196716, 9.4043332), U=c(1, 2.6635105, 5.8407897, 9.9199406, 12.7128930))
ggplot(df, aes(x=Education, y=Odds_Ratio, color=Education)) + scale_x_discrete(limits=edulevels)+ geom_point(size=4) + geom_errorbar(aes(ymax=U, ymin=L, width=0.3)) +theme(axis.text.x=element_blank(), axis.text.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title.y=element_text(size=16)) 

## Plot adjusted OR for General Health Status with 95% CI
ghslevels<-c("Excellent","Very Good", "Good", "Fair", "Poor")
df<-data.frame(General_Health_Status=c("Excellent","Very Good", "Good", "Fair", "Poor"), Odds_Ratio=c(1, 1.2182542, 1.1503056, 1.1893854, 0.9384644), L=c(1, 1.1132032, 1.0604219, 1.0452734, 0.7763436), U=c(1, 1.3332186, 1.2478080, 1.3533661, 1.1344401))
ggplot(df, aes(x=General_Health_Status, y=Odds_Ratio, color=General_Health_Status))+ scale_x_discrete(limits=ghslevels) + geom_point(size=4) + geom_errorbar(aes(ymax=U, ymin=L, width=0.3)) +theme(axis.text.x=element_blank(), axis.text.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title.y=element_text(size=16)) 
```

In the model adjusting for all covariates, the data suggested that women had 1.64 (95% confidence interval [CI]: 1.54, 1.76) times higher odds of than men to use internet to obtain health information. Compared to younger people (aged 19-45 years), people aged 46-65 years and elderly aged 65 years and above had 0.85 times (95% CI: 0.79, 0.91) and 0.47 times (95% CI: 0.43, 0.51) lower odds of using internet to seek health information, respectively. Compared to single/unmarried people, married people or those living with partner had 1.19 (95% CI: 1.08, 1.30) higher odds, while divorced/seperated 0.98 (95% CI: 0.87, 1.10) and widowed 0.52 (95% CI: 0.44, 0.62) people had lower odds of using Internet to obtain health topics. White subjects generally had higher odds of using Internet to get health information than other ethinicity groups. Higher education levels were associated with significant higher odds of using Internet to obtain health information. Compared to people with excellent general health status, those with suboptimal health status had at least 1.15 times of higher odds to get health information online, except for those with poor health status. 

```{r eval=TRUE}
## Final models ##
# Even though the crude and adjusted ORs of BMI and region were not significant in the models above, these variables were pre-selected and were still included in the final models for smoking status and alcohol drinking status. 
# Fit the FINAL model for smoking status adjusting for all covariates
glm.a <- svyglm(outcome ~ factor(smkstat2) + factor(agecat) + factor(sex) + factor(r_maritl) + factor (region) + factor(racerpi2) + factor(bmicat) + factor(educ1) + factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit)

summary(svyglm(outcome ~ factor(smkstat2) + factor(agecat) + factor(sex) + factor(r_maritl) + factor (region) + factor(racerpi2) + factor(bmicat) + factor(educ1) + factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit))
# Adjusted ORs
exp(summary(svyglm(outcome ~ factor(smkstat2) + factor(agecat) + factor(sex) + factor(r_maritl) + factor (region) + factor(racerpi2) + factor(bmicat) + factor(educ1) + factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
# Calculate 95% CIs
exp(confint(glm.a))
## Plot the adjusted ORs for smoking status with 95%CIs
require(ggplot2)
smklevel<-c("Never smoker", "Former smoker", "Current some day smoker", "Current every day smoker")
df<-data.frame(Smoking_Status=c("Never smoker", "Former smoker", "Current some day smoker", "Current every day smoker"), Odds_Ratio=c(1, 1.5051298, 1.1150029, 1.0163021), L=c(1, 1.3917464, 0.9479489, 0.9044045), U=c(1, 1.6277505, 1.3114964, 1.1420443))
ggplot(df, aes(x=Smoking_Status, y=Odds_Ratio, color=Smoking_Status)) + geom_point(size=4) + geom_errorbar(aes(ymax=U, ymin=L, width=0.3)) +theme(axis.text.x=element_blank(), axis.text.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title.y=element_text(size=16)) 

# Fit the FINAL model for alcohol drinking status adjusting for all covariates
glm.b <- svyglm(outcome ~ factor(alcstat2) + factor(agecat) + factor(sex) + factor(r_maritl) + factor (region) + factor(racerpi2) + factor(bmicat) + factor(educ1) + factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit)

summary(svyglm(outcome ~ factor(alcstat2) + factor(agecat) + factor(sex) + factor(r_maritl) + factor (region) + factor(racerpi2) + factor(bmicat) + factor(educ1) + factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit))
# Adjusted ORs
exp(summary(svyglm(outcome ~ factor(alcstat2) + factor(agecat) + factor(sex) + factor(r_maritl) + factor (region) + factor(racerpi2) + factor(bmicat) + factor(educ1) + factor(phstat),family=quasibinomial, design=nhissvy, na.action=na.omit))$coefficient)
# 95% CIs
exp(confint(glm.b))

## Plot the adjusted ORs for alcohol drinking status with 95%CI
require(ggplot2)
df<-data.frame(Alcohol_Drinking_Status=c("Lifetime abstainer", "Former drinker", "Current light drinker", "Current moderate-heavy drinker"), Odds_Ratio=c(1, 1.45478142, 1.81929548, 1.96952643), L=c(1, 1.2928306, 1.6614314, 1.7625661), U=c(1, 1.6370195, 1.9921593, 2.2007881))
ggplot(df, aes(x=Alcohol_Drinking_Status, y=Odds_Ratio, color=Alcohol_Drinking_Status)) + geom_point(size=4) + geom_errorbar(aes(ymax=U, ymin=L, width=0.3)) +theme(axis.text.x=element_blank(), axis.text.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title.y=element_text(size=16)) 
```

After adjusting for all covariates, former smoker is statistically significantly associated with 1.50 (95% CI: 1.39, 1.63) times higher odds of using Internet to get health information compared to people who never smoked. Compared to never smokers, current some day smokers had 1.12 (95% CI: 0.95, 1.31) times higher odds and every day smoker had 1.02 (95% CI: 0.90, 1.14) times lower odds, although both estimates were not statistically significant. One possible explanation is that health information obtained from the Internet helped past smokers to quit smoking. One study conducted by Shahab et al using Health Information National Trend Survey reported that compared to current non-smokers, current smokers had a 1.90 times (95% CI: 1.35, 2.68) higher odds of obtaining behavioral support online, primarily for getting support for smoking cessation (11). The differences in the definition of smoking status may account for the observed differences in the ORs between our analysis and the study of Shahab et al. They did not differentiate never smokers from former smokers but group them all as current non-smokers. However, both analysis suggested that Internet may be an effective medium to provide support for smoking cessation. 

Compared to life time abstainers, former drinkers (1.27, 95% CI: 1.10, 1.46), current infrequent-light drinkers (1.39, 95% CI: 1.25, 1.54) or current moderate to heavier drinkers (1.49, 95% CI: 1.32, 1.68) all had statistically significantly higher odds of reported use of Internet to obtain health information adjusting for all covariates. While we observed an association, Shahab et al found no association between excessive alcohol consumption and use of Internet for health-related information, use Internet as first source for health-related information and Internet use for behavioral support. These could be due to the different research questions being addressed as they were looking into specifically association between excess alcohol consumption and Internet use. In their study, respondants were asked to report number of drinks they consumed on the days they did drink, while NHIS classified subjects into different drinking status according to their responses to several different questions which assessed their alcohol consumption levels  both in the past 12 months and during their entire lifetime. 

Lastly, the observed associations between social demographic covariates and Internet use remained significant in both models adjusting for health behavior factors suggested independent associations between these covariates and Internet use. Being younger, female, married/living with partners, having higher education, with white ethinicity and having poorer general health status were correlated with using Internet to get health information. These findings were in agreement with literatures (10,11). 

One strength of the study is that it uses a large national representative survey which collected information on a wide range of covariates. However, because of the cross-sectional nature of this study, we could not establish any causal relationship between the variables. The outcome variable captures only the use of Internet to obtain health information by the interviewees, while we do not know if they are looking for health information for themselves or others. For example, it is possible that the married participants had higher odds of using Internet because they are more likely to look for health information for their families. Future studies are needed to investigate the causal relationship between the variables and to understand the underlying mechanism of the observed associations.

This study suggested significant associations between people with different health behaviors and use of Internet to obtain health information. This findings could help researchers to understand the characteristics of the population who are actively looking for health information online and may use the information to develop health promotion programs that better targets the population at risk. 

References:
(1) Pew Research Center. Health Fact Sheet. http://www.pewinternet.org/fact-sheets/health-fact-sheet/ [Accessed November 1, 2015.]
(2) Fox S, Duggan Maeve. Health Online 2013. http://www.pewinternet.org/2013/01/15/health-online-2013/ [Accessed November 1, 2015.]
(3) Bujnowska-Fedak MM. Trends in the use of the Internet for health purposes in Poland. BMC Public Health. 2015 Feb 27;15:194. doi: 10.1186/s12889-015-1473-3
(4) Rice RE. Influences, usage, and outcomes of Internet health information searching: multivariate results from the Pew surveys. Int J Med Inform. 2006 Jan;75(1):8-28. Epub 2005 Aug 24.
(5) Ybarra ML, Suman M. Help seeking behavior and the Internet: a national survey. Int J Med Inform. 2006 Jan;75(1):29-41. Epub 2005 Aug 29.
(6) Webb Tl, Joseph J, Yardley L, Michie S. Using the internet to promote health behavior change: a systematic review and meta-analysis of the impact of theoretical basis, use of behavior change techniques, and mode of delivery on efficacy. J Med Internet Res. 2010;12(1):e4. doi: 10.2196/jmir.1376. http://www.jmir.org/2010/1/e4/ 
(7) Shahab L, McEwen A. Online support for smoking cessation: a systematic review of the literature. Addiction. 2009 Nov;104(11):1792–804. doi: 10.1111/j.1360-0443.2009.02710.x.
(8) White A, Kavanagh D, Stallman H, Klein B, Kay-Lambkin F, Proudfoot J, Drennan J, Connor J, Baker A, Hines E, Young R. Online alcohol interventions: a systematic review. J Med Internet Res. 2010;12(5):e62. doi: 10.2196/jmir.1479.
(9) Vandelanotte C, Spathonis KM, Eakin EG, Owen N. Website-delivered physical activity interventions a review of the literature. Am J Prev Med. 2007 Jul;33(1):54–64. doi: 10.1016/j.amepre.2007.02.041.
(10) Amante DJ, Hogan TP, Pagoto SL, English TM, Lapane KL. Access to care and use of the Internet to search for health information: results from the US National Health Interview Survey. J Med Internet Res. 2015 Apr 29;17(4):e106. doi: 10.2196/jmir.4126.
(11) Shahab L, Brown J, Gardner B, Smith SG. Seeking Health Information and Support Online: Does It Differ as a Function of Engagement in Risky Health Behaviors? Evidence From the Health Information National Trends Survey. Eysenbach G, ed. Journal of Medical Internet Research. 2014;16(11):e253. doi:10.2196/jmir.3368.